(this["webpackJsonpreact-messenger"]=this["webpackJsonpreact-messenger"]||[]).push([[0],{55:function(e,t,a){},56:function(e,t,a){},66:function(e,t,a){"use strict";a.r(t);var c=a(8),n=a.n(c),r=a(44),s=a.n(r),i=(a(55),a(56),a(27)),l=a(16),j=a(0),o=a.n(j),u=a(1),b=a(12),d=a(45),O=a(28),m=a(11),x=a(20),h=Object(d.a)({apiKey:"AIzaSyCQkuSPCHV05rN3mK3Abg-eWUYl5FcGq8k",authDomain:"chatapp01-d2ca2.firebaseapp.com",projectId:"chatapp01-d2ca2",storageBucket:"chatapp01-d2ca2.appspot.com",messagingSenderId:"118836018874",appId:"1:118836018874:web:0f93ef663b114e46b9cc83"}),p=Object(O.b)(h),f=Object(m.f)(h),v=Object(x.c)(h),g=a.p+"static/media/image1.f02b66c0.jpg",w=a(5),N=function(e){var t=e.user1,a=e.user,n=e.selectUser,r=e.chat,s=null===a||void 0===a?void 0:a.uid,i=Object(c.useState)(""),l=Object(b.a)(i,2),j=l[0],o=l[1];return Object(c.useEffect)((function(){var e="".concat(t>s?t+s:s+t),a=Object(m.g)(Object(m.d)(f,"lastMsg",e),(function(e){o(e.data())}));return function(){return a()}}),[]),Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("div",{className:"user_wrapper ".concat(r.name===a.name&&"selected_user"),onClick:function(){return n(a)},children:[Object(w.jsxs)("div",{className:"user_info",children:[Object(w.jsxs)("div",{className:"user_detail",children:[Object(w.jsx)("img",{src:a.avatar||g,alt:"avatar",className:"avatar"}),Object(w.jsx)("h4",{children:a.name}),(null===j||void 0===j?void 0:j.from)!==t&&(null===j||void 0===j?void 0:j.unread)&&Object(w.jsx)("small",{className:"unread",children:"New"})]}),Object(w.jsx)("div",{className:"user_status ".concat(a.isOnline?"online":"offline")})]}),j&&Object(w.jsxs)("p",{className:"truncate",children:[Object(w.jsx)("strong",{children:j.from===t?"Me:":null}),j.text]})]}),Object(w.jsx)("div",{onClick:function(){return n(a)},className:"sm_container ".concat(r.name===a.name&&"selected_user"),children:Object(w.jsx)("img",{src:a.avatar||g,alt:"avatar",className:"avatar sm_screen"})})]})},y=function(){return Object(w.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",style:{width:"25px",height:"25px",cursor:"pointer",color:"gray"},viewBox:"0 0 20 20",fill:"currentColor",children:Object(w.jsx)("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z",clipRule:"evenodd"})})},k=function(e){var t=e.handleSubmit,a=e.text,c=e.setText,n=e.setImg;return Object(w.jsxs)("form",{className:"message_form",onSubmit:t,children:[Object(w.jsx)("label",{htmlFor:"img",children:Object(w.jsx)(y,{})}),Object(w.jsx)("input",{onChange:function(e){return n(e.target.files[0])},type:"file",id:"img",accept:"image/*",style:{display:"none"}}),Object(w.jsx)("div",{children:Object(w.jsx)("input",{type:"text",placeholder:"Enter message",value:a,onChange:function(e){return c(e.target.value)}})}),Object(w.jsx)("div",{children:Object(w.jsx)("button",{className:"btn",children:"Send"})})]})},_=a(46),S=a.n(_),C=function(e){var t=e.msg,a=e.user1,n=Object(c.useRef)();return Object(c.useEffect)((function(){var e;null===(e=n.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[t]),Object(w.jsx)("div",{className:"message_wrapper ".concat(t.from===a?"own":""),ref:n,children:Object(w.jsxs)("p",{className:t.from===a?"me":"friend",children:[t.media?Object(w.jsx)("img",{src:t.media,alt:t.text}):null,t.text,Object(w.jsx)("br",{}),Object(w.jsx)("small",{children:Object(w.jsx)(S.a,{fromNow:!0,children:t.createdAt.toDate()})})]})})},A=function(){var e=Object(c.useState)([]),t=Object(b.a)(e,2),a=t[0],n=t[1],r=Object(c.useState)(""),s=Object(b.a)(r,2),i=s[0],l=s[1],j=Object(c.useState)(""),d=Object(b.a)(j,2),O=d[0],h=d[1],g=Object(c.useState)(""),y=Object(b.a)(g,2),_=y[0],S=y[1],A=Object(c.useState)([]),D=Object(b.a)(A,2),P=D[0],F=D[1],M=p.currentUser.uid;Object(c.useEffect)((function(){var e=Object(m.c)(f,"users"),t=Object(m.i)(e,Object(m.l)("uid","not-in",[M])),a=Object(m.g)(t,(function(e){var t=[];e.forEach((function(e){t.push(e.data())})),n(t)}));return function(){return a()}}),[]);var E=function(){var e=Object(u.a)(o.a.mark((function e(t){var a,c,n,r,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(t),a=t.uid,c="".concat(M>a?M+a:a+M),n=Object(m.c)(f,"messages",c,"chat"),r=Object(m.i)(n,Object(m.h)("createdAt","asc")),Object(m.g)(r,(function(e){var t=[];e.forEach((function(e){t.push(e.data())})),F(t)})),e.next=8,Object(m.e)(Object(m.d)(f,"lastMsg",c));case 8:if(!(s=e.sent).data()||s.data().from===M){e.next=12;break}return e.next=12,Object(m.k)(Object(m.d)(f,"lastMsg",c),{unread:!1});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(u.a)(o.a.mark((function e(t){var a,c,n,r,s,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=i.uid,c="".concat(M>a?M+a:a+M),!_){e.next=12;break}return r=Object(x.d)(v,"images/".concat((new Date).getTime()," - ").concat(_.name)),e.next=7,Object(x.e)(r,_);case 7:return s=e.sent,e.next=10,Object(x.b)(Object(x.d)(v,s.ref.fullPath));case 10:l=e.sent,n=l;case 12:return e.next=14,Object(m.b)(Object(m.c)(f,"messages",c,"chat"),{text:O,from:M,to:a,createdAt:m.a.fromDate(new Date),media:n||""});case 14:return e.next=16,Object(m.j)(Object(m.d)(f,"lastMsg",c),{text:O,from:M,to:a,createdAt:m.a.fromDate(new Date),media:n||"",unread:!0});case 16:h(""),S("");case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsxs)("div",{className:"home_container",children:[Object(w.jsx)("div",{className:"users_container",children:a.map((function(e){return Object(w.jsx)(N,{user:e,selectUser:E,user1:M,chat:i},e.uid)}))}),Object(w.jsx)("div",{className:"messages_container",children:i?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"messages_user",children:Object(w.jsx)("h3",{children:i.name})}),Object(w.jsx)("div",{className:"messages",children:P.length?P.map((function(e,t){return Object(w.jsx)(C,{msg:e,user1:M},t)})):null}),Object(w.jsx)(k,{handleSubmit:I,text:O,setText:h,setImg:S})]}):Object(w.jsx)("h3",{className:"no_conv",children:"Select a user to start conversation"})})]})},D=function(){return Object(w.jsx)("div",{style:{position:"relative"},children:Object(w.jsx)("h2",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:"Loading..."})})},P=Object(c.createContext)(),F=function(e){var t=e.children,a=Object(c.useState)(null),n=Object(b.a)(a,2),r=n[0],s=n[1],i=Object(c.useState)(!0),l=Object(b.a)(i,2),j=l[0],o=l[1];return Object(c.useEffect)((function(){Object(O.c)(p,(function(e){s(e),o(!1)}))}),[]),j?Object(w.jsx)(D,{}):Object(w.jsx)(P.Provider,{value:{user:r},children:t})},M=function(){var e=Object(l.g)(),t=Object(c.useContext)(P).user,a=function(){var t=Object(u.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.k)(Object(m.d)(f,"users",p.currentUser.uid),{isOnline:!1});case 2:return t.next=4,Object(O.e)(p);case 4:e.replace("/login");case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(w.jsxs)("nav",{children:[Object(w.jsx)("h3",{children:Object(w.jsx)(i.b,{to:"/",children:"Messenger"})}),Object(w.jsx)("div",{children:t?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(i.b,{to:"/profile",children:"Profile"}),Object(w.jsx)("button",{className:"btn",onClick:a,children:"Logout"})]}):Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(i.b,{to:"/register",children:"Register"}),Object(w.jsx)(i.b,{to:"/login",children:"Login"})]})})]})},E=a(4),I=a(15),L=function(){var e=Object(c.useState)({name:"",email:"",password:"",error:null,loading:!1}),t=Object(b.a)(e,2),a=t[0],n=t[1],r=Object(l.g)(),s=a.name,i=a.email,j=a.password,d=a.error,x=a.loading,h=function(e){n(Object(I.a)(Object(I.a)({},a),{},Object(E.a)({},e.target.name,e.target.value)))},v=function(){var e=Object(u.a)(o.a.mark((function e(t){var c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n(Object(I.a)(Object(I.a)({},a),{},{error:null,loading:!0})),s&&i&&j||n(Object(I.a)(Object(I.a)({},a),{},{error:"All fields are required"})),e.prev=3,e.next=6,Object(O.a)(p,i,j);case 6:return c=e.sent,e.next=9,Object(m.j)(Object(m.d)(f,"users",c.user.uid),{uid:c.user.uid,name:s,email:i,createdAt:m.a.fromDate(new Date),isOnline:!0});case 9:n({name:"",email:"",password:"",error:null,loading:!1}),r.replace("/"),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),n(Object(I.a)(Object(I.a)({},a),{},{error:e.t0.message,loading:!1}));case 16:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsxs)("section",{children:[Object(w.jsx)("h3",{children:"Create An Account"}),Object(w.jsxs)("form",{className:"form",onSubmit:v,children:[Object(w.jsxs)("div",{className:"input_container",children:[Object(w.jsx)("label",{htmlFor:"name",children:"Name"}),Object(w.jsx)("input",{type:"text",name:"name",value:s,onChange:h})]}),Object(w.jsxs)("div",{className:"input_container",children:[Object(w.jsx)("label",{htmlFor:"email",children:"Email"}),Object(w.jsx)("input",{type:"text",name:"email",value:i,onChange:h})]}),Object(w.jsxs)("div",{className:"input_container",children:[Object(w.jsx)("label",{htmlFor:"password",children:"Password"}),Object(w.jsx)("input",{type:"password",name:"password",value:j,onChange:h})]}),d?Object(w.jsx)("p",{className:"error",children:d}):null,Object(w.jsx)("div",{className:"btn_container",children:Object(w.jsx)("button",{className:"btn",disabled:x,children:x?"Creating ...":"Register"})})]})]})},R=function(){var e=Object(c.useState)({email:"",password:"",error:null,loading:!1}),t=Object(b.a)(e,2),a=t[0],n=t[1],r=Object(l.g)(),s=a.email,i=a.password,j=a.error,d=a.loading,x=function(e){n(Object(I.a)(Object(I.a)({},a),{},Object(E.a)({},e.target.name,e.target.value)))},h=function(){var e=Object(u.a)(o.a.mark((function e(t){var c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n(Object(I.a)(Object(I.a)({},a),{},{error:null,loading:!0})),s&&i||n(Object(I.a)(Object(I.a)({},a),{},{error:"All fields are required"})),e.prev=3,e.next=6,Object(O.d)(p,s,i);case 6:return c=e.sent,e.next=9,Object(m.k)(Object(m.d)(f,"users",c.user.uid),{isOnline:!0});case 9:n({email:"",password:"",error:null,loading:!1}),r.replace("/"),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),n(Object(I.a)(Object(I.a)({},a),{},{error:e.t0.message,loading:!1}));case 16:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsxs)("section",{children:[Object(w.jsx)("h3",{children:"Log into your Account"}),Object(w.jsxs)("form",{className:"form",onSubmit:h,children:[Object(w.jsxs)("div",{className:"input_container",children:[Object(w.jsx)("label",{htmlFor:"email",children:"Email"}),Object(w.jsx)("input",{type:"text",name:"email",value:s,onChange:x})]}),Object(w.jsxs)("div",{className:"input_container",children:[Object(w.jsx)("label",{htmlFor:"password",children:"Password"}),Object(w.jsx)("input",{type:"password",name:"password",value:i,onChange:x})]}),j?Object(w.jsx)("p",{className:"error",children:j}):null,Object(w.jsx)("div",{className:"btn_container",children:Object(w.jsx)("button",{className:"btn",disabled:d,children:d?"Logging in ...":"Login"})})]})]})},z=function(){return Object(w.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",style:{width:"25px",height:"25px",cursor:"pointer"},viewBox:"0 0 20 20",fill:"currentColor",children:Object(w.jsx)("path",{fillRule:"evenodd",d:"M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1 0 015.586 5H4zm6 9a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})})},U=function(e){var t=e.deleteImage;return Object(w.jsx)("svg",{onClick:t,xmlns:"http://www.w3.org/2000/svg",style:{width:"25px",height:"25px",cursor:"pointer",color:"#f24957"},viewBox:"0 0 20 20",fill:"currentColor",children:Object(w.jsx)("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})},V=function(){var e=Object(c.useState)(""),t=Object(b.a)(e,2),a=t[0],n=t[1],r=Object(c.useState)(),s=Object(b.a)(r,2),i=s[0],j=s[1],d=Object(l.g)("");Object(c.useEffect)((function(){if(Object(m.e)(Object(m.d)(f,"users",p.currentUser.uid)).then((function(e){e.exists&&j(e.data())})),a){var e=function(){var e=Object(u.a)(o.a.mark((function e(){var t,c,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Object(x.d)(v,"avatar/".concat((new Date).getTime()," - ").concat(a.name)),e.prev=1,!i.avatarPath){e.next=5;break}return e.next=5,Object(x.a)(Object(x.d)(v,i.avatarPath));case 5:return e.next=7,Object(x.e)(t,a);case 7:return c=e.sent,e.next=10,Object(x.b)(Object(x.d)(v,c.ref.fullPath));case 10:return r=e.sent,e.next=13,Object(m.k)(Object(m.d)(f,"users",p.currentUser.uid),{avatar:r,avatarPath:c.ref.fullPath});case 13:n(""),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),console.log(e.t0.message);case 19:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(){return e.apply(this,arguments)}}();e()}}),[a]);var O=function(){var e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!window.confirm("Delete avatar?")){e.next=8;break}return e.next=5,Object(x.a)(Object(x.d)(v,i.avatarPath));case 5:return e.next=7,Object(m.k)(Object(m.d)(f,"users",p.currentUser.uid),{avatar:"",avatarPath:""});case 7:d.replace("/");case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0.message);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return i?Object(w.jsx)("section",{children:Object(w.jsxs)("div",{className:"profile_container",children:[Object(w.jsxs)("div",{className:"img_container",children:[Object(w.jsx)("img",{src:i.avatar||g,alt:"avatar"}),Object(w.jsx)("div",{className:"overlay",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("label",{htmlFor:"photo",children:Object(w.jsx)(z,{})}),i.avatar?Object(w.jsx)(U,{deleteImage:O}):null,Object(w.jsx)("input",{type:"file",accept:"image/*",style:{display:"none"},id:"photo",onChange:function(e){return n(e.target.files[0])}})]})})]}),Object(w.jsxs)("div",{className:"text_container",children:[Object(w.jsx)("h3",{children:i.name}),Object(w.jsx)("p",{children:i.email}),Object(w.jsx)("hr",{}),Object(w.jsxs)("small",{children:["Joined on: ",i.createdAt.toDate().toDateString()]})]})]})}):null},H=a(49),B=["component"],T=function(e){var t=e.component,a=Object(H.a)(e,B),n=Object(c.useContext)(P).user;return Object(w.jsx)(l.b,Object(I.a)(Object(I.a)({},a),{},{exact:!0,render:function(e){return n?Object(w.jsx)(t,Object(I.a)({},e)):Object(w.jsx)(l.a,{to:"/login"})}}))};var q=function(){return Object(w.jsx)(F,{children:Object(w.jsxs)(i.a,{children:[Object(w.jsx)(M,{}),Object(w.jsxs)(l.d,{children:[Object(w.jsx)(l.b,{exact:!0,path:"/register",component:L}),Object(w.jsx)(l.b,{exact:!0,path:"/login",component:R}),Object(w.jsx)(T,{exact:!0,path:"/profile",component:V}),Object(w.jsx)(T,{exact:!0,path:"/",component:A})]})]})})};s.a.render(Object(w.jsx)(n.a.StrictMode,{children:Object(w.jsx)(q,{})}),document.getElementById("root"))}},[[66,1,2]]]);
//# sourceMappingURL=main.12e26289.chunk.js.map